<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <title>Miniscript playground</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
  </head>
  <body>
    
    
    <!-- Contenedor envoltorio -->
    <div class="main-wrapper">
      
      <!-- Contenido superior -->
      <div class="top-panel">
        <div class="top-panel-inner">
          <img src="./MiniscriptRustLogo.png" alt="Logo" class="top-panel-logo">
          <span class="top-panel-title"> <h1> 🛝 Miniscript playground 🛝 </h1></span>
        </div>
      </div>

      <div class="container">

        <!-- Columna izquierda: Menú de proyectos -->
        <div class="menu">
          <h2>🗂️ Pólizas disponibles</h2>
          
          <!-- 🟦 Fila 1: Botón Autocustodia -->
          <div class="button-row">
            <button class="app-button" onclick="setActiveButton(this); loadProjectByURL('/htmls/herencia.html')">🧬 Herencia digital</button>
          </div>
          <!-- 🟩 Fila 2: Botón Bóveda -->
          <div class="button-row">
            <button class="app-button" onclick="setActiveButton(this); loadProjectByURL('/htmls/autocustodia.html')">🤖 Autocustodia programada</button>
          </div>
          <!-- 🟧 Fila 3: Botón Herencia -->
          <div class="button-row">
            <button class="app-button" onclick="setActiveButton(this); loadProjectByURL('/htmls/boveda.html')">🏦 Bóveda de seguridad</button>
          </div>
          <div id="output" class="output-console"></div>
        </div>
      
          <!-- Columna derecha: Contenido del proyecto -->
          <div class="content">
            <h2></h2>
            <div id="content"></div>
          </div>

      </div>
    </div>

    <script>

      function setActiveButton(button) {
        document.querySelectorAll('.menu .app-button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
      }


      function loadProjectByURL(proyectoUrl) {

        // Cargar el contenido de la página seleccionada usando la URL proporcionada
        fetch(proyectoUrl)
          .then(response => {
            if (!response.ok) {
              throw new Error('Error al cargar el contenido: ' + response.statusText);
            }
            return response.text();
          })
          .then(html => {
            document.getElementById('content').innerHTML = html;
    
            // Extraer el nombre del archivo sin la carpeta ni la extensión autocustodia.html >> autocustodia
            const scriptName = proyectoUrl.split('/').pop().split('.')[0];
    
            // Eliminar scripts anteriores del mismo tipo si existen para evitar duplicados
            const oldScript = document.querySelector(`script[src="./dist/${scriptName}.bundle.js"]`);
            if (oldScript) {
              oldScript.remove();
            }
    
            // Cargar un script específico para la página
            const script = document.createElement('script');
            script.src = `./dist/${scriptName}.bundle.js`;
            document.body.appendChild(script); // Añadir al final del body
        
// Añadir el árbol de emojis según el proyecto seleccionado
if (scriptName === 'autocustodia') {
  document.getElementById('output').innerHTML = `<pre>
🌳 <span style="color:blue;">Descripción de las ramas de gasto</span> 🌳


<b>🤖 Autocustodia programada 🤖</b>
│    
│
├─ 🗓️ <b>Uso diario: ➡️ 🔑🔑 de 🔑🔑🔑</b>
│  │ 
│  ├─ 🗝️ Llave principal 
│  │ 
│  ├─ 🗝️ Llave secundaria
│  │ 
│  └─ 🗝️ Llave del custodio
│    
│    
├─ 🛡️<b> Recuperación: 🕒 3 meses ➡️ 🔑 de 🔑🔑 </b>
│  │ 
│  ├─ 🗝️ Llave de respaldo principal
│  │ 
│  └─ 🗝️ Llave de respaldo secundaria
│    
│    
└─ 🚨<b> Emergencia: ⏰ 5 meses ➡️ 🔑  </b>
   │ 
   └─ 🗝️ Llave de apertura por perdida
</pre>
  `;
} else if (scriptName === 'boveda') {
  document.getElementById('output').innerHTML = `<pre>
🌳 <span style="color:blue;">Descripción de las ramas de gasto</span> 🌳


<b>🏦 Bóveda de seguridad 🏦</b>
│
│
├─ 🔧 <b>Apertura forzada: 🕒 72 horas ➡️ 🔑</b>
│  │ 
│  └─ 🗝️ Llave de aperura retardada
│
│
└─ 🆘 <b>Botón del pánico: ➡️ 🔑</b>
   │
   └─ 🗝️ Llave de apertura inmediata
</pre>
  `;

} else if (scriptName === 'herencia') {
  document.getElementById('output').innerHTML = `<pre>
🌳 <span style="color:blue;">Descripción de las ramas de gasto</span> 🌳


<b>🧬 Herencia digital 🧬 </b>
│
│
├─ 🧓🏻 <b>Acceso inmediato: ➡️ 🔑</b>
│  │ 
│  └─ 🗝️ Llave del progenitor
│
│
├─ 🧑🏻👨🏻 <b>Herencia: 🕒 3 años ➡️ 🔑🔑 de 🔑🔑</b>
│  │ 
│  ├─ 🗝️ Llave de la heredera
│  │ 
│  └─ 🗝️ Llave del heredero
│
│
└─ 👤 <b>Disputa: ⏰ 5 años ➡️ 🔑</b>
   │ 
   └─ 🗝️ Llave del abogado
</pre>
  `;

} else {
  document.getElementById('output').innerHTML = '';
}
              })
            .catch(error => {
              console.error('Error:', error);
              document.getElementById('content').innerHTML = `<p>Error al cargar el proyecto: ${error.message}</p>`;
            });
        }
      
    
      // Autocargar el primer proyecto al iniciar
      document.addEventListener('DOMContentLoaded', () => {
        // Selecciona el primer botón del menú (Autocustodia)
        const firstButton = document.querySelector('.menu .app-button');
        if (firstButton) {
          setActiveButton(firstButton);
        }
        loadProjectByURL('/htmls/herencia.html');
      });
    
    </script>
  </body>
</html>